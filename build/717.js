"use strict";(globalThis.webpackChunkthirty_three=globalThis.webpackChunkthirty_three||[]).push([[717],{717:(e,t,o)=>{let n;o.d(t,{mountViewer:()=>s});const r=(e=0,t)=>t.MathUtils.degToRad(Number.isFinite(e)?e:Number(e)||0),i=e=>{const t=(e||"0x004100").toString().replace(/^#/,"").replace(/^0x/,""),o=parseInt(t,16);return Number.isFinite(o)?o:16640},a=(e,t,o)=>Math.min(Math.max(e,t),o),s=async(e,t={})=>{if(!e)return{destroy:()=>{},update:()=>{}};return((e,t,o={})=>{const{THREE:n,ThreeMFLoader:s}=t,{interactive:l=!0,logTransforms:c=!0}=o,d=e.dataset||{},h=e.querySelector(".thirty-three-viewport"),m=e.querySelector(".thirty-three-placeholder"),p=e.querySelector(".thirty-three-status"),w=d.fileUrl||"",u=e=>{p&&(p.textContent=e)};if(!h)return()=>{};const g=d.imageUrl||"";let y=a(Number(d.scale)||1,.1,2),x={x:r(Number(d.rotationX)||0,n),y:r(Number(d.rotationY)||0,n),z:r(Number(d.rotationZ)||0,n)},M=i(d.color);if(g&&m?.querySelector("img")&&(m.querySelector("img").src=g),!w)return u("No 3MF file selected."),()=>{};const v=new n.WebGLRenderer({antialias:!0,alpha:!0});v.setPixelRatio(window.devicePixelRatio||1),v.setSize(h.clientWidth,h.clientHeight||320),v.outputEncoding=n.sRGBEncoding,v.toneMapping=n.ACESFilmicToneMapping,h.appendChild(v.domElement);const b=new n.Scene;b.background=new n.Color(725536);const E=new n.PerspectiveCamera(50,h.clientWidth/Math.max(h.clientHeight,1),.1,5e3);E.position.set(0,0,30),b.add(new n.AmbientLight(16777215,.6));const L=new n.DirectionalLight(16777215,1.15);L.position.set(28,22,24),L.castShadow=!0,b.add(L);const F=new n.DirectionalLight(8246268,.6);let S;F.position.set(-16,-10,-22),b.add(F);let f=!1,C={x:0,y:0},P=30,T=4,N=200,R=Math.PI/2,z=Math.PI/2;const D=new n.LoadingManager,O=new s(D);D.onStart=()=>{m?.classList.remove("is-hidden"),u("Loading 3D modelâ€¦")},D.onError=e=>{u("Could not load 3D model. Check console for details."),console.error("[thirty-three] LoadingManager error",e)};const $=()=>{const e=Math.sin(z),t=P*e*Math.cos(R),o=P*Math.cos(z),n=P*e*Math.sin(R);E.position.set(t,o,n),E.lookAt(0,0,0)},Y=e=>{e.rotation.set(x.x,x.y,x.z),e.traverse(e=>{e.isMesh&&(e.castShadow=!0,e.receiveShadow=!0,e.material=e.material.clone(),e.material.color=new n.Color(M))})},k=()=>{v.render(b,E)},H=()=>{if(!c)return;if(!S)return;const e=n.MathUtils.radToDeg(S.rotation.x),t=n.MathUtils.radToDeg(S.rotation.y),o=n.MathUtils.radToDeg(S.rotation.z),{x:r,y:i,z:a}=S.position;console.clear(),console.log(`Position X: ${r.toFixed(2)}`),console.log(`Position Y: ${i.toFixed(2)}`),console.log(`Position Z: ${a.toFixed(2)}`),console.log(`Rotation X: ${e.toFixed(2)} degrees`),console.log(`Rotation Y: ${t.toFixed(2)} degrees`),console.log(`Rotation Z: ${o.toFixed(2)} degrees`),console.log(`Scale: ${S.scale.x.toFixed(2)}`),console.log(`Camera Distance: ${P.toFixed(2)}`),console.log(`Camera Azimuth: ${R.toFixed(2)} rad`),console.log(`Camera Polar: ${z.toFixed(2)} rad`)},X=e=>{f=!0,C={x:e.clientX,y:e.clientY}},j=()=>{f=!1},U=e=>{if(!f)return;const t=e.clientX-C.x,o=e.clientY-C.y;R+=.01*t,z=a(z+.01*o,.1,Math.PI-.1),C={x:e.clientX,y:e.clientY},$(),k(),H()},A=e=>{if(!S)return;e.preventDefault();const t=e.deltaY>0?1:-1;P*=t>0?1.08:.92,P=a(P,T,N),$(),k(),H()},q=()=>{const e=h.clientWidth||1,t=h.clientHeight||1;v.setSize(e,t),E.aspect=e/t,E.updateProjectionMatrix(),k()};return l&&(h.addEventListener("pointerdown",X),window.addEventListener("pointerup",j),window.addEventListener("pointermove",U),h.addEventListener("wheel",A,{passive:!1})),window.addEventListener("resize",q),v.setAnimationLoop(k),w?O.load(w,e=>{u("3D model ready"),m?.classList.add("is-hidden"),S&&b.remove(S),S=e,Y(S),(e=>{const t=e.scale.clone();e.scale.setScalar(1);const o=(new n.Box3).setFromObject(e),r=o.getCenter(new n.Vector3);e.position.sub(r);const i=o.getSize(new n.Vector3),a=(Math.max(i.x,i.y,i.z)||1)/(2*Math.tan(n.MathUtils.degToRad(.5*E.fov)));P=Math.max(1.4*a,6),T=Math.max(.25*P,2),N=Math.max(8*P,50),$(),e.scale.copy(t)})(S),S.scale.setScalar(y),b.add(S),k(),H()},void 0,e=>{u("Could not load 3D model. Check console for details."),m?.classList.remove("is-hidden"),console.error("[thirty-three] 3MFLoader error",e)}):u("No 3MF file selected."),q(),{destroy:()=>{l&&(h.removeEventListener("pointerdown",X),window.removeEventListener("pointerup",j),window.removeEventListener("pointermove",U),h.removeEventListener("wheel",A)),window.removeEventListener("resize",q),v.setAnimationLoop(null),v.dispose(),v.domElement?.parentNode===h&&h.removeChild(v.domElement)},update:(e={})=>{Object.prototype.hasOwnProperty.call(e,"scale")&&(y=a(Number(e.scale)||1,.01,2)),Object.prototype.hasOwnProperty.call(e,"rotationX")&&(x.x=r(Number(e.rotationX)||0,n)),Object.prototype.hasOwnProperty.call(e,"rotationY")&&(x.y=r(Number(e.rotationY)||0,n)),Object.prototype.hasOwnProperty.call(e,"rotationZ")&&(x.z=r(Number(e.rotationZ)||0,n)),Object.prototype.hasOwnProperty.call(e,"color")&&(M=i(e.color)),S&&(Y(S),S.scale.setScalar(y),k(),H())}}})(e,await(n||(n=(async()=>{const e=window.THREE||await o.e(437).then(o.bind(o,437)),t=e.default||e,n=await Promise.all([o.e(437),o.e(462)]).then(o.bind(o,462)),r=n.ThreeMFLoader||n.default||n;return window.THREE||(window.THREE=t),{THREE:t,ThreeMFLoader:r}})(),n)),t)}}}]);