"use strict";(globalThis.webpackChunkthirty_three=globalThis.webpackChunkthirty_three||[]).push([[717],{717:(e,t,o)=>{let n;o.d(t,{mountViewer:()=>s});const r=(e=0,t)=>t.MathUtils.degToRad(Number.isFinite(e)?e:Number(e)||0),i=e=>{const t=(e||"0x004100").toString().replace(/^#/,"").replace(/^0x/,""),o=parseInt(t,16);return Number.isFinite(o)?o:16640},a=(e,t,o)=>Math.min(Math.max(e,t),o),s=async(e,t={})=>{if(!e)return{destroy:()=>{},update:()=>{}};return((e,t,o={})=>{const{THREE:n,ThreeMFLoader:s}=t,{interactive:l=!0,logTransforms:c=!0}=o,d=e.dataset||{},h=e.querySelector(".thirty-three-viewport"),p=e.querySelector(".thirty-three-placeholder"),m=e.querySelector(".thirty-three-status"),w=d.fileUrl||"",u=e=>{m&&(m.textContent=e)};if(!h)return()=>{};const g=d.imageUrl||"";let y=a(Number(d.scale)||1,.1,2),x={x:r(Number(d.rotationX)||0,n),y:r(Number(d.rotationY)||0,n),z:r(Number(d.rotationZ)||0,n)},v=i(d.color);if(g&&p?.querySelector("img")&&(p.querySelector("img").src=g),!w)return u("No 3MF file selected."),()=>{};const b=new n.WebGLRenderer({antialias:!0,alpha:!0});b.setPixelRatio(window.devicePixelRatio||1),b.setSize(h.clientWidth,h.clientHeight||320),b.outputEncoding=n.sRGBEncoding,b.toneMapping=n.ACESFilmicToneMapping,h.appendChild(b.domElement);const E=new n.Scene;E.background=new n.Color(725536);const L=new n.PerspectiveCamera(50,h.clientWidth/Math.max(h.clientHeight,1),.1,5e3);L.position.set(0,0,30),E.add(new n.AmbientLight(16777215,.6));const M=new n.DirectionalLight(16777215,1.15);M.position.set(28,22,24),M.castShadow=!0,E.add(M);const S=new n.DirectionalLight(8246268,.6);let F;S.position.set(-16,-10,-22),E.add(S);let f=!1,T={x:0,y:0},C=30,N=4,R=200;const P=new n.LoadingManager,z=new s(P);P.onStart=()=>{p?.classList.remove("is-hidden"),u("Loading 3D modelâ€¦")},P.onError=e=>{u("Could not load 3D model. Check console for details."),console.error("[thirty-three] LoadingManager error",e)};const D=e=>{e.rotation.set(x.x,x.y,x.z),e.traverse(e=>{e.isMesh&&(e.castShadow=!0,e.receiveShadow=!0,e.material=e.material.clone(),e.material.color=new n.Color(v))})},O=()=>{b.render(E,L)},Y=()=>{if(!c)return;if(!F)return;const e=n.MathUtils.radToDeg(F.rotation.x),t=n.MathUtils.radToDeg(F.rotation.y),o=n.MathUtils.radToDeg(F.rotation.z),{x:r,y:i,z:a}=F.position;console.clear(),console.log(`Position X: ${r.toFixed(2)}`),console.log(`Position Y: ${i.toFixed(2)}`),console.log(`Position Z: ${a.toFixed(2)}`),console.log(`Rotation X: ${e.toFixed(2)} degrees`),console.log(`Rotation Y: ${t.toFixed(2)} degrees`),console.log(`Rotation Z: ${o.toFixed(2)} degrees`),console.log(`Scale: ${F.scale.x.toFixed(2)}`),console.log(`Camera Distance: ${C.toFixed(2)}`)},k=e=>{f=!0,T={x:e.clientX,y:e.clientY}},H=()=>{f=!1},X=e=>{if(!f||!F)return;const t=e.clientX-T.x,o=e.clientY-T.y;F.rotation.y+=.01*t,F.rotation.x+=.01*o,T={x:e.clientX,y:e.clientY},O(),Y()},$=e=>{if(!F)return;e.preventDefault();const t=e.deltaY>0?1:-1;C*=t>0?1.08:.92,C=a(C,N,R),L.position.set(0,0,C),O(),Y()},j=()=>{const e=h.clientWidth||1,t=h.clientHeight||1;b.setSize(e,t),L.aspect=e/t,L.updateProjectionMatrix(),O()};return l&&(h.addEventListener("pointerdown",k),window.addEventListener("pointerup",H),window.addEventListener("pointermove",X),h.addEventListener("wheel",$,{passive:!1})),window.addEventListener("resize",j),b.setAnimationLoop(O),w?z.load(w,e=>{u("3D model ready"),p?.classList.add("is-hidden"),F&&E.remove(F),F=e,D(F),(e=>{const t=e.scale.clone();e.scale.setScalar(1);const o=(new n.Box3).setFromObject(e),r=o.getCenter(new n.Vector3);e.position.sub(r);const i=o.getSize(new n.Vector3),a=(Math.max(i.x,i.y,i.z)||1)/(2*Math.tan(n.MathUtils.degToRad(.5*L.fov)));C=Math.max(1.4*a,6),N=Math.max(.25*C,2),R=Math.max(8*C,50),L.position.set(0,0,C),L.lookAt(0,0,0),e.scale.copy(t)})(F),F.scale.setScalar(y),E.add(F),O(),Y()},void 0,e=>{u("Could not load 3D model. Check console for details."),p?.classList.remove("is-hidden"),console.error("[thirty-three] 3MFLoader error",e)}):u("No 3MF file selected."),j(),{destroy:()=>{l&&(h.removeEventListener("pointerdown",k),window.removeEventListener("pointerup",H),window.removeEventListener("pointermove",X),h.removeEventListener("wheel",$)),window.removeEventListener("resize",j),b.setAnimationLoop(null),b.dispose(),b.domElement?.parentNode===h&&h.removeChild(b.domElement)},update:(e={})=>{Object.prototype.hasOwnProperty.call(e,"scale")&&(y=a(Number(e.scale)||1,.01,2)),Object.prototype.hasOwnProperty.call(e,"rotationX")&&(x.x=r(Number(e.rotationX)||0,n)),Object.prototype.hasOwnProperty.call(e,"rotationY")&&(x.y=r(Number(e.rotationY)||0,n)),Object.prototype.hasOwnProperty.call(e,"rotationZ")&&(x.z=r(Number(e.rotationZ)||0,n)),Object.prototype.hasOwnProperty.call(e,"color")&&(v=i(e.color)),F&&(D(F),F.scale.setScalar(y),O(),Y())}}})(e,await(n||(n=(async()=>{const e=window.THREE||await o.e(437).then(o.bind(o,437)),t=e.default||e,n=await Promise.all([o.e(437),o.e(462)]).then(o.bind(o,462)),r=n.ThreeMFLoader||n.default||n;return window.THREE||(window.THREE=t),{THREE:t,ThreeMFLoader:r}})(),n)),t)}}}]);