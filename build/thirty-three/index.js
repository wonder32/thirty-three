(()=>{"use strict";var e,t,r,i={625:(e,t,r)=>{const i=window.wp.blocks,a=window.wp.i18n,l=window.wp.blockEditor,o=window.wp.components,n=window.wp.element,s=window.ReactJSXRuntime,d=(e="")=>e?e.startsWith("0x")?e:e.startsWith("#")?`0x${e.slice(1)}`:`0x${e.replace("#","")}`:"",c=(e="",t="#004100")=>e?e.startsWith("#")?e:e.startsWith("0x")?`#${e.slice(2)}`:`#${e}`:t,h=JSON.parse('{"UU":"create-block/thirty-three"}');(0,i.registerBlockType)(h.UU,{edit:function({attributes:e,setAttributes:t}){const{imageId:i,imageUrl:h,fileId:u,fileUrl:m,scale:p,rotationX:v,rotationY:_,rotationZ:x,color:y}=e,f=(0,l.useBlockProps)({className:"thirty-three-editor"}),g=(0,n.useRef)(null),b=(0,n.useRef)(null);return(0,n.useEffect)(()=>{const e=g.current;if(!e)return;e.dataset.imageUrl=h||"",e.dataset.fileUrl=m||"",e.dataset.scale=String(Number(null!=p?p:1)),e.dataset.rotationX=String(Number(null!=v?v:0)),e.dataset.rotationY=String(Number(null!=_?_:0)),e.dataset.rotationZ=String(Number(null!=x?x:0)),e.dataset.color=y||"0x004100";const t=e.querySelector(".thirty-three-placeholder"),r=e.querySelector(".thirty-three-status");if(!m)return t?.classList.remove("is-hidden"),r&&(r.textContent=(0,a.__)("No 3MF file selected.","thirty-three")),void e.querySelector("canvas")?.remove();b.current?.update&&b.current.update({scale:p,rotationX:v,rotationY:_,rotationZ:x,color:y})},[h,m,p,v,_,x,y]),(0,n.useEffect)(()=>{if(!m)return b.current?.destroy?.(),void(b.current=null);const e=g.current;if(!e)return;let t=!1;return r.e(717).then(r.bind(r,717)).then(t=>t.mountViewer(e,{interactive:!1,logTransforms:!1})).then(e=>{t?e?.destroy?.():(b.current?.destroy?.(),b.current=e,e?.update?.({scale:p,rotationX:v,rotationY:_,rotationZ:x,color:y}))}).catch(e=>{console.error("[thirty-three] Preview mount failed",e)}),()=>{t=!0}},[m]),(0,n.useEffect)(()=>()=>{b.current?.destroy?.(),b.current=null},[]),(0,s.jsxs)("div",{...f,children:[m?(0,s.jsx)("div",{className:"thirty-three-preview",children:(0,s.jsxs)("div",{ref:g,className:"thirty-three-block","data-image-url":h||"","data-file-url":m||"","data-scale":null!=p?p:1,"data-rotation-x":null!=v?v:0,"data-rotation-y":null!=_?_:0,"data-rotation-z":null!=x?x:0,"data-color":y||"0x004100",children:[(0,s.jsx)("div",{className:"thirty-three-viewport",children:(0,s.jsxs)("div",{className:"thirty-three-placeholder",children:[h?(0,s.jsx)("img",{src:h,alt:"",loading:"lazy"}):(0,s.jsx)("span",{children:(0,a.__)("3D preview","thirty-three")}),(0,s.jsx)("div",{className:"thirty-three-loader","aria-hidden":"true",children:(0,s.jsx)("div",{className:"thirty-three-loader__bar"})})]})}),(0,s.jsx)("div",{className:"thirty-three-status",role:"status","aria-live":"polite",children:m?"Loading 3D model…":"No 3MF file selected."})]})}):(0,s.jsx)("div",{className:"component-card",children:(0,s.jsxs)("div",{className:"component-card__body",children:[(0,s.jsx)("div",{className:"component-card__title",children:(0,a.__)("3MF preview","thirty-three")}),(0,s.jsx)("div",{className:"component-card__description",children:(0,a.__)("Select a 3MF file in the sidebar to see a live preview.","thirty-three")}),(0,s.jsx)(o.Flex,{gap:8,align:"center",className:"component-card__actions",children:(0,s.jsx)(o.Button,{variant:"primary",onClick:()=>{},disabled:!0,children:(0,a.__)("Waiting for file","thirty-three")})})]})}),(0,s.jsx)(l.InspectorControls,{children:(0,s.jsx)(o.PanelBody,{title:(0,a.__)("3MF Settings","thirty-three"),initialOpen:!0,children:(0,s.jsxs)("div",{className:"thirty-three-editor__sidebar-grid",children:[(0,s.jsxs)("div",{className:"thirty-three-editor__media-input",children:[(0,s.jsx)("span",{className:"thirty-three-editor__media-label",children:(0,a.__)("Preview image","thirty-three")}),h?(0,s.jsx)("img",{src:h,alt:(0,a.__)("3MF preview","thirty-three"),style:{width:"100%",height:"auto",borderRadius:"4px",marginBottom:"0.5rem"}}):(0,s.jsx)("p",{children:(0,a.__)("No image selected","thirty-three")}),(0,s.jsx)(l.MediaUploadCheck,{children:(0,s.jsx)(l.MediaUpload,{onSelect:e=>{var r,i,a;t({imageId:null!==(r=e?.id)&&void 0!==r?r:null,imageUrl:null!==(i=null!==(a=e?.sizes?.medium?.url)&&void 0!==a?a:e?.url)&&void 0!==i?i:""})},value:null!=i?i:void 0,allowedTypes:["image"],render:({open:e})=>(0,s.jsx)(o.Button,{variant:"secondary",onClick:e,children:i?(0,a.__)("Change image","thirty-three"):(0,a.__)("Select image","thirty-three")})})}),i&&(0,s.jsx)(o.Button,{variant:"link",isDestructive:!0,onClick:()=>t({imageId:null,imageUrl:""}),children:(0,a.__)("Remove image","thirty-three")})]}),(0,s.jsxs)("div",{className:"thirty-three-editor__media-input",children:[(0,s.jsx)("span",{className:"thirty-three-editor__media-label",children:(0,a.__)("3MF file","thirty-three")}),m?(0,s.jsx)("p",{className:"thirty-three-editor__file-path",children:m}):(0,s.jsx)("p",{children:(0,a.__)("No 3MF file selected","thirty-three")}),(0,s.jsx)(l.MediaUploadCheck,{children:(0,s.jsx)(l.MediaUpload,{onSelect:e=>{var r,i;t({fileId:null!==(r=e?.id)&&void 0!==r?r:null,fileUrl:null!==(i=e?.url)&&void 0!==i?i:""})},value:null!=u?u:void 0,render:({open:e})=>(0,s.jsx)(o.Button,{variant:"secondary",onClick:e,children:u?(0,a.__)("Change file","thirty-three"):(0,a.__)("Select 3MF file","thirty-three")})})}),u&&(0,s.jsx)(o.Button,{variant:"link",isDestructive:!0,onClick:()=>t({fileId:null,fileUrl:""}),children:(0,a.__)("Remove file","thirty-three")})]}),(0,s.jsx)(o.RangeControl,{label:(0,a.__)("Zoom","thirty-three"),value:Number(null!=p?p:1),onChange:e=>t({scale:Number(null!=e?e:1)}),min:.01,max:2,step:.01,help:(0,a.__)("0.01–2.00 applied after fit; 1 = natural size.","thirty-three"),__next40pxDefaultSize:!0,__nextHasNoMarginBottom:!0}),(0,s.jsx)(o.RangeControl,{label:(0,a.__)("Rotation X (°)","thirty-three"),value:Number(null!=v?v:0),onChange:e=>t({rotationX:Number(null!=e?e:0)}),min:-180,max:180,step:1,__next40pxDefaultSize:!0,__nextHasNoMarginBottom:!0}),(0,s.jsx)(o.RangeControl,{label:(0,a.__)("Rotation Y (°)","thirty-three"),value:Number(null!=_?_:0),onChange:e=>t({rotationY:Number(null!=e?e:0)}),min:-180,max:180,step:1,__next40pxDefaultSize:!0,__nextHasNoMarginBottom:!0}),(0,s.jsx)(o.RangeControl,{label:(0,a.__)("Rotation Z (°)","thirty-three"),value:Number(null!=x?x:0),onChange:e=>t({rotationZ:Number(null!=e?e:0)}),min:-180,max:180,step:1,__next40pxDefaultSize:!0,__nextHasNoMarginBottom:!0}),(0,s.jsxs)("div",{className:"thirty-three-editor__color-input",children:[(0,s.jsx)("span",{className:"thirty-three-editor__media-label",children:(0,a.__)("Colour","thirty-three")}),(0,s.jsx)(o.ColorPicker,{color:c(y),onChangeComplete:e=>{var r;t({color:d(null!==(r=e?.hex)&&void 0!==r?r:e)})},disableAlpha:!0}),(0,s.jsx)(o.TextControl,{label:(0,a.__)("Hex colour (0x format)","thirty-three"),value:null!=y?y:"0x0a9a16",onChange:e=>t({color:d(e)}),help:(0,a.__)("Example: 0x0a9a16 for pure green.","thirty-three"),__next40pxDefaultSize:!0,__nextHasNoMarginBottom:!0})]})]})})})]})},save:function({attributes:e}){const{imageUrl:t="",fileUrl:r="",scale:i=.1,rotationX:a=0,rotationY:o=0,rotationZ:n=0,color:d="0x004100"}=null!=e?e:{},c=l.useBlockProps.save({className:"thirty-three-block","data-image-url":t,"data-file-url":r,"data-scale":i,"data-rotation-x":a,"data-rotation-y":o,"data-rotation-z":n,"data-color":d});return(0,s.jsxs)("div",{...c,children:[(0,s.jsx)("div",{className:"thirty-three-viewport",children:(0,s.jsxs)("div",{className:"thirty-three-placeholder",children:[t?(0,s.jsx)("img",{src:t,alt:"",loading:"lazy"}):(0,s.jsx)("span",{children:"3D preview"}),(0,s.jsx)("div",{className:"thirty-three-loader","aria-hidden":"true",children:(0,s.jsx)("div",{className:"thirty-three-loader__bar"})})]})}),(0,s.jsx)("div",{className:"thirty-three-status",role:"status","aria-live":"polite",children:r?"Loading 3D model…":"No 3MF file selected."})]})}})}},a={};function l(e){var t=a[e];if(void 0!==t)return t.exports;var r=a[e]={exports:{}};return i[e](r,r.exports,l),r.exports}l.m=i,e=[],l.O=(t,r,i,a)=>{if(!r){var o=1/0;for(c=0;c<e.length;c++){for(var[r,i,a]=e[c],n=!0,s=0;s<r.length;s++)(!1&a||o>=a)&&Object.keys(l.O).every(e=>l.O[e](r[s]))?r.splice(s--,1):(n=!1,a<o&&(o=a));if(n){e.splice(c--,1);var d=i();void 0!==d&&(t=d)}}return t}a=a||0;for(var c=e.length;c>0&&e[c-1][2]>a;c--)e[c]=e[c-1];e[c]=[r,i,a]},l.d=(e,t)=>{for(var r in t)l.o(t,r)&&!l.o(e,r)&&Object.defineProperty(e,r,{enumerable:!0,get:t[r]})},l.f={},l.e=e=>Promise.all(Object.keys(l.f).reduce((t,r)=>(l.f[r](e,t),t),[])),l.u=e=>e+".js?ver="+{437:"591209c61890728e6e9a",462:"9cdc3fa36504c5e33821",717:"f906ff2cb9736739eaa0"}[e],l.miniCssF=e=>{},l.o=(e,t)=>Object.prototype.hasOwnProperty.call(e,t),t={},r="thirty-three:",l.l=(e,i,a,o)=>{if(t[e])t[e].push(i);else{var n,s;if(void 0!==a)for(var d=document.getElementsByTagName("script"),c=0;c<d.length;c++){var h=d[c];if(h.getAttribute("src")==e||h.getAttribute("data-webpack")==r+a){n=h;break}}n||(s=!0,(n=document.createElement("script")).charset="utf-8",l.nc&&n.setAttribute("nonce",l.nc),n.setAttribute("data-webpack",r+a),n.src=e),t[e]=[i];var u=(r,i)=>{n.onerror=n.onload=null,clearTimeout(m);var a=t[e];if(delete t[e],n.parentNode&&n.parentNode.removeChild(n),a&&a.forEach(e=>e(i)),r)return r(i)},m=setTimeout(u.bind(null,void 0,{type:"timeout",target:n}),12e4);n.onerror=u.bind(null,n.onerror),n.onload=u.bind(null,n.onload),s&&document.head.appendChild(n)}},l.r=e=>{"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},(()=>{var e;globalThis.importScripts&&(e=globalThis.location+"");var t=globalThis.document;if(!e&&t&&(t.currentScript&&"SCRIPT"===t.currentScript.tagName.toUpperCase()&&(e=t.currentScript.src),!e)){var r=t.getElementsByTagName("script");if(r.length)for(var i=r.length-1;i>-1&&(!e||!/^http(s?):/.test(e));)e=r[i--].src}if(!e)throw new Error("Automatic publicPath is not supported in this browser");e=e.replace(/^blob:/,"").replace(/#.*$/,"").replace(/\?.*$/,"").replace(/\/[^\/]+$/,"/"),l.p=e+"../"})(),(()=>{var e={657:0,669:0};l.f.j=(t,r)=>{var i=l.o(e,t)?e[t]:void 0;if(0!==i)if(i)r.push(i[2]);else if(669!=t){var a=new Promise((r,a)=>i=e[t]=[r,a]);r.push(i[2]=a);var o=l.p+l.u(t),n=new Error;l.l(o,r=>{if(l.o(e,t)&&(0!==(i=e[t])&&(e[t]=void 0),i)){var a=r&&("load"===r.type?"missing":r.type),o=r&&r.target&&r.target.src;n.message="Loading chunk "+t+" failed.\n("+a+": "+o+")",n.name="ChunkLoadError",n.type=a,n.request=o,i[1](n)}},"chunk-"+t,t)}else e[t]=0},l.O.j=t=>0===e[t];var t=(t,r)=>{var i,a,[o,n,s]=r,d=0;if(o.some(t=>0!==e[t])){for(i in n)l.o(n,i)&&(l.m[i]=n[i]);if(s)var c=s(l)}for(t&&t(r);d<o.length;d++)a=o[d],l.o(e,a)&&e[a]&&e[a][0](),e[a]=0;return l.O(c)},r=globalThis.webpackChunkthirty_three=globalThis.webpackChunkthirty_three||[];r.forEach(t.bind(null,0)),r.push=t.bind(null,r.push.bind(r))})();var o=l.O(void 0,[669],()=>l(625));o=l.O(o)})();